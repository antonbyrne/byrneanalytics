{% extends 'layout.html' %}

{% block title %}FTSE 100 Volatility Index{% endblock %}

{% block content %}
<div class="card">
    <h2>FTSE 100 Market Volatility Index</h2>
    <p>This index tracks the relative 7-day volatility of the FTSE 100. Higher scores reflect greater fear or instability in the UK market.</p>
    <canvas id="ftseChart" width="800" height="400"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const dates = {{ dates | tojson }};
const values = {{ values | tojson }};

const borderColors = values.map(val => val > 50 ? 'red' : 'green');
const backgroundColors = values.map(val => val > 50 ? 'rgba(255,0,0,0.1)' : 'rgba(0,128,0,0.1)');

const ctx = document.getElementById('ftseChart').getContext('2d');
const ftseChart = new Chart(ctx, {
    type: 'line',
    data: {
        labels: dates,
        datasets: [{
            label: 'Volatility Score (0 = Calm, 100 = Panic)',
            data: values,
            borderColor: borderColors,
            backgroundColor: backgroundColors,
            borderWidth: 2,
            tension: 0.3,
            fill: true,
            pointRadius: 4,
            pointHoverRadius: 6
        }]
    },
    options: {
        responsive: true,
        scales: {
            y: {
                min: 0,
                max: 100,
                title: {
                    display: true,
                    text: 'Volatility Index (0â€“100)'
                }
            },
            x: {
                title: {
                    display: true,
                    text: 'Date'
                }
            }
        },
        plugins: {
            tooltip: {
                callbacks: {
                    label: function(context) {
                        const val = context.parsed.y;
                        return `Score: ${val} (${val > 50 ? 'High Volatility' : 'Stable'})`;
                    }
                }
            }
        }
    }
});
</script>
{% endblock %}
